{
    "actions": [
        {
            "type": "@comment",
            "parameters": {
                "text": {
                    "value": "b23.tv trace parameter cleanup"
                }
            }
        },
        {
            "type": "@flow.javascript",
            "parameters": {
                "script": {
                    "value": "(()=>{$app.strings={en:{COPY:\"Copy\",COPIED:\"Copied\",\"b23clean.converting\":\"Converting...\",\"b23clean.noUrl\":\"No link detected\",\"b23clean.noBiliUrl\":\"bilibili link not detected\",\"b23clean.success\":\"Converted to BV video link\"},\"zh-Hans\":{COPY:\"复制\",COPIED:\"已复制\",\"b23clean.converting\":\"正在转换...\",\"b23clean.noUrl\":\"未检测到链接\",\"b23clean.noBiliUrl\":\"未检测到 bilibili 链接\",\"b23clean.success\":\"已转换为 BV 视频链接\"}},$app.theme=\"auto\",$app.minSDKVer=\"2.19.0\",$app.minOSVer=\"14.0.0\",$app.idleTimerDisabled=!1,$app.keyboardToolbarEnabled=!0,$app.rotateDisabled=!1;class t{static#t=$objc(\"UIApplication\").$sharedApplication();static#e=$objc(\"UINotificationFeedbackGenerator\").$new();static feedbackSuccess(){t.#e.$notificationOccurred(0)}static feedbackError(){t.#e.$notificationOccurred(2)}static align={left:0,right:1,top:2,bottom:3};static textColor=$color(\"primaryText\");static linkColor=$color(\"systemLink\");static primaryViewBackgroundColor=$color(\"primarySurface\");static scrollViewBackgroundColor=$color(\"insetGroupedBackground\");static scrollViewList=[\"list\",\"matrix\"];static isLargeScreen=$device.isIpad||$device.isIpadPro;static get windowSize(){return $objc(\"UIWindow\").$keyWindow().jsValue().size}static NavigationBarNormalHeight=$objc(\"UINavigationController\").invoke(\"alloc.init\").$navigationBar().jsValue().frame.height;static NavigationBarLargeTitleHeight=$objc(\"UITabBarController\").invoke(\"alloc.init\").$tabBar().jsValue().frame.height+t.NavigationBarNormalHeight;static get isSplitScreenMode(){return t.isLargeScreen&&$device.info.screen.width!==t.windowSize.width}static get topSafeAreaInsets(){return t.#t?.$keyWindow()?.$safeAreaInsets()?.top??0}static get bottomSafeAreaInsets(){return t.#t?.$keyWindow()?.$safeAreaInsets()?.bottom??0}static get statusBarOrientation(){return t.#t.$statusBarOrientation()}static get consoleBarHeight(){if($app.isDebugging){let e=t.#t.$statusBarFrame().height+26;return $device.isIphoneX&&(e+=30),e}return 0}static get isHorizontal(){return 3===t.statusBarOrientation||4===t.statusBarOrientation}static loading(){const e=$ui.create(t.blurBox({cornerRadius:15},[{type:\"spinner\",props:{loading:!0,style:0},layout:(t,e)=>{t.size.equalTo(e.prev),t.center.equalTo(e.super)}}]));return{start:()=>{$ui.controller.view.insertAtIndex(e,0),e.layout(((e,i)=>{e.center.equalTo(i.super);const a=Math.min(.6*Math.min(t.windowSize.width,t.windowSize.height),260);e.size.equalTo($size(a,a))})),e.moveToFront()},end:()=>{e.remove()}}}static defaultBackgroundColor(e){return t.scrollViewList.indexOf(e)>-1?t.scrollViewBackgroundColor:t.primaryViewBackgroundColor}static separatorLine(e={},i=t.align.bottom){return{type:\"canvas\",props:e,layout:(e,a)=>{void 0===a.prev?e.top.equalTo(a.super):i===t.align.bottom?e.top.equalTo(a.prev.bottom):e.top.equalTo(a.prev.top),e.height.equalTo(1/$device.info.screen.scale),e.left.right.inset(0)},events:{draw:(t,i)=>{i.strokeColor=e.bgcolor??$color(\"separatorColor\"),i.setLineWidth(1),i.moveToPoint(0,0),i.addLineToPoint(t.frame.width,0),i.strokePath()}}}}static blurBox(t={},e=[],i=$layout.fill){return{type:\"blur\",props:Object.assign({style:$blurStyle.thinMaterial},t),views:e,layout:i}}static getContentSize(e,i=\"A\",a=t.windowSize.width,o){const s={text:i,width:a,font:e};return void 0!==o&&(s.lineSpacing=o),$text.sizeThatFits(s)}static getSymbolSize(t,e){const i=(t=\"string\"==typeof t?$image(t):t).size.width/t.size.height;return t.size.width>t.size.height?$size(e,e/i):$size(e*i,e)}static push({views:t,statusBarStyle:e=0,title:i=\"\",navButtons:a=[{title:\"\"}],bgcolor:o=t[0]?.props?.bgcolor??\"primarySurface\",titleView:s,disappeared:r}={}){const n={statusBarStyle:e,navButtons:a,title:i,bgcolor:\"string\"==typeof o?$color(o):o};s&&(n.titleView=s),$ui.push({props:n,events:{disappeared:()=>{void 0!==r&&r()}},views:[{type:\"view\",views:t,layout:(t,e)=>{t.top.equalTo(e.super.safeArea),t.bottom.equalTo(e.super),t.left.right.equalTo(e.super.safeArea)}}]})}}var e={UIKit:t}.UIKit;class i{static type={info:void 0,success:\"checkmark\",warning:\"exclamationmark.triangle\",error:\"xmark.circle\"};static edges=40;static iconSize=100;static labelTopMargin=10;static defaultFont=$font(\"default\",26);width=Math.min(.6*e.windowSize.width,260);labelWidth=this.width-2*i.edges;id=$text.uuid;#i=\"\";font=i.defaultFont;type=i.type.info;labelLines=2;constructor(t,e=i.type.info,a=2,o=i.defaultFont){this.type=e,this.message=t,this.labelLines=a,this.font=o}get message(){return this.#i}set message(t){this.#i=t,this.fontHeight=e.getContentSize(this.font,this.message,this.labelWidth,this.labelLines).height,this.height=(this.hasIcon?i.labelTopMargin+i.iconSize:0)+this.fontHeight+2*i.edges}get hasIcon(){return void 0!==this.type}get blurBox(){const t=e.blurBox({id:this.id,cornerRadius:15,alpha:0},[{type:\"image\",props:{symbol:this.type,hidden:!this.hasIcon,tintColor:$color(\"lightGray\")},layout:(t,e)=>{t.top.inset(i.edges),t.size.equalTo(i.iconSize),t.centerX.equalTo(e.super)}},{type:\"label\",props:{font:this.font,text:this.message,align:$align.center,lines:this.labelLines,color:$color(\"lightGray\")},layout:(t,e)=>{t.bottom.equalTo(e.supper).offset(-i.edges),t.width.equalTo(this.labelWidth),t.height.equalTo(this.fontHeight),t.centerX.equalTo(e.super)}}]);return t.events={tapped:()=>{this.remove()}},t}show(){$ui.controller.view.insertAtIndex($ui.create(this.blurBox),0);const t=$(this.id);t.layout(((t,e)=>{t.center.equalTo(e.super),t.size.equalTo($size(this.width,this.height))})),t.moveToFront(),$ui.animate({duration:.2,animation:()=>{t.alpha=1}})}remove(){const t=$(this.id);t&&$ui.animate({duration:.2,animation:()=>{t.alpha=0},completion:()=>{t.remove()}})}static toast({message:t,type:e=i.type.info,show:a=!0,displayTime:o=2,labelLines:s=2,font:r=i.defaultFont}){const n=new i(t,e,s,r);return a&&(n.show(),$delay(o,(()=>{n.remove()}))),n}static info(t,e={}){return i.toast(Object.assign({message:t,type:i.type.info},e))}static success(t,e={}){return i.toast(Object.assign({message:t,type:i.type.success},e))}static warning(t,e={}){return i.toast(Object.assign({message:t,type:i.type.warning},e))}static error(t,e={}){return i.toast(Object.assign({message:t,type:i.type.error},e))}}var a={Toast:i}.Toast;async function o(){const t=a.info($l10n(\"b23clean.converting\"),{show:!1});try{const e=(()=>{const t=[$actions.inputValue,$clipboard.text];for(let e=0;e<t.length;e++)if(t[e]&&\"\"!==t[e])return t[e];return\"\"})().match(/(https?:\\/\\/)([\\da-z\\.-]+)\\.([a-z\\.]{2,6})([:0-9])*([\\/\\w\\#\\.\\-\\?\\=\\&])*\\s?/gi)??[];if(0===e.length)throw new Error($l10n(\"b23clean.noUrl\"));let i=e[0];if(e.length>1){const t=await $ui.menu({items:e});i=e[t.index]}if(-1===i.indexOf(\"bilibili.com\")&&-1===i.indexOf(\"b23.tv\"))throw new Error($l10n(\"b23clean.noBiliUrl\"));t.show(),i=await async function(t){if(-1===t.indexOf(\"bilibili.com\")&&-1===t.indexOf(\"b23.tv\"))throw new Error($l10n(\"b23clean.noBiliUrl\"));let e=t;t.indexOf(\"b23.tv\")>=0&&(e=(await $http.get(t)).response.url);const i=e.indexOf(\"?\");return i>-1&&(e=e.substring(0,i-1)),e}(i),t.remove(),await $ui.alert({title:$l10n(\"b23clean.success\"),message:i,actions:[{title:$l10n(\"OK\")},{title:$l10n(\"COPY\"),handler:()=>{$clipboard.text=i,a.success($l10n(\"COPIED\"))}}]})}catch(e){t.remove(),$delay(.5,(()=>a.error(String(e))))}}({run:()=>{o().catch((t=>console.error(t)))}}).run()})();"
                }
            }
        }
    ],
    "buildVersion": 1,
    "clientMinVersion": 1,
    "summary": "",
    "icon": {
        "glyph": "trash",
        "color": "#FF3300"
    },
    "clientVersion": 592,
    "name": "b23clean"
}